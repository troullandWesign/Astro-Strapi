---
const { champion } = Astro.props;

const { id, nom, description, image, roles } = champion;

// Gestion de l’image
const imageUrl = image?.formats?.medium?.url || image?.url
  ? (image?.formats?.medium?.url || image?.url).startsWith('/')
    ? `http://localhost:1337${image?.formats?.medium?.url || image?.url}`
    : (image?.formats?.medium?.url || image?.url)
  : null;

// Texte alternatif pour accessibilité
const altText = image?.alternativeText || nom || 'Image de champion';

// Gestion des rôles (Strapi v5, many-to-many)
const roleNames = roles?.length > 0 ? roles.map(r => r.nom).join(', ') : null;
---

<div class="border rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow">
  {imageUrl && (
    <div class="h-48 overflow-hidden">
      <img 
        src={imageUrl} 
        alt={altText} 
        class="w-full h-full object-cover"
      />
    </div>
  )}

  <div class="p-4">
    <h2 class="text-xl font-semibold">{nom}</h2>

    {roleNames && (
      <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mt-1 mb-2">
        {roleNames}
      </span>
    )}

    <p class="text-gray-600">{description}</p>

    <a 
      href={`/champion/${id}`} 
      class="mt-3 inline-block text-blue-500 hover:text-blue-700 hover:underline"
    >
      Voir détails
    </a>
  </div>
</div>
